<!DOCTYPE html>
<html lang="en">
<head>
    <title>VK Elektronikos ir informatikos fakultetas</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Marius Gžegoževskis">
    <meta name="description" content="Vilniaus kolegijos EIF tvarkaraščių laikinieji pakeitimai">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/css/index.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.12/css/all.css"
          integrity="sha384-G0fIWCsCzJIMAVNQPfjH08cyYaUtMwjJwqiRKxxE/rx96Uroj1BtIQ6MLJuheaO9" crossorigin="anonymous">


    <!--http://learnjsdata.com/read_data.html BEST LIB READ FILES-->


    <link rel="stylesheet" href="css/style.css">


    <link rel="manifest" href="/manifest.json">
    <!--<script src="bundle.js"></script>-->
    <script src="js/d3.v5.min.js"></script>

    <!--<script src="https://d3js.org/d3.v5.min.js" ></script>-->
    <script src="js/jquery.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script src="jquery-1.10.2.js"></script>
    <script src="pikaday.js"></script>
    <script src="moment/min/moment.min.js"></script>
    <script src="moment/min/moment-with-locales.min.js"></script>
    <script src="pwabuilder-sw-register.js"></script>

    <!--<script src='dist/jquery.min.js'></script>-->
    <script src='dist/isotope.pkgd.js'></script>
    <script src="js/index.js"></script>
    <!--<script src="https://unpkg.com/isotope-layout@3/dist/isotope.pkgd.min.js"></script>-->


    <!--<script>-->
    <!--// Firbease Init-->
    <!--const config = {-->
    <!--apiKey: "AIzaSyCRYVIHl_orktaBMwsmlQtMcOaeGO0FTQI",-->
    <!--authDomain: "eif-courses.firebaseapp.com",-->
    <!--databaseURL: "https://eif-courses.firebaseio.com",-->
    <!--projectId: "eif-courses",-->
    <!--storageBucket: "eif-courses.appspot.com",-->
    <!--messagingSenderId: "535363326769"-->
    <!--};-->
    <!--firebase.initializeApp(config);-->

    <!--</script>-->


    <!--// CORS BLOKAVIMUI: https://app.requestly.in/rules/-->

    <!--SKRIPTAS UZKRAUTI DESTYTOJAMS IS WEBO-->
    <script>
        $(document).ready(function () {


            $('.grid').hide();
            let csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ3Ir7o171E-tSFv4PJXvINjZvuBwin6cTi3eqlwHwH_sLwrtuSrJqn8WW4VFZYJs4kD1Eaqm3iYBus/pub?output=csv";
            $('.grid').html("");
            d3.csv(csvUrl).then(function (data) {
                localStorage.setItem("konsultacijos", JSON.stringify(data));
            });

            fetch('https://vikoeif.edupage.org/timetable/').then(function (response) {
                return response.text();
            }).then(function (string) {
                let matched = string.match(/{"table":"teachers",[\w\W]*?\(-a\)"}]}/gm);
                // console.log(matched[0]);
                localStorage.setItem('dest', matched[0]);
            }).catch(function (err) {
                console.log('Fetch Error', err);
            });
            //window.localStorage.removeItem('dest');
            //window.localStorage.removeItem('konsultacijos');


            // $.get('https://vikoeif.edupage.org/timetable/').success(function(data){
            //     let matched = data.match(/{"table":"teachers",[\w\W]*?\(-a\)"}]}/gm);
            //     //for (let k in matched[0]) {
            //     localStorage.setItem('dest', matched[0]);
            //     // console.log(JSON.parse(matched[0]).rows[k].short,
            //     //     JSON.parse(matched[0]).rows[k].id,
            //     //     "https://vikoeif.edupage.org/timetable/view.php?teacher=" + JSON.parse(matched[0]).rows[k].id.toString() + "");
            //
            //     // }
            //
            // });


            const konsultacijos = JSON.parse(localStorage.getItem('konsultacijos'));
            const destytojai = JSON.parse(localStorage.getItem('dest')).rows;


            // TIPAS: 1 - > PATALPA, 2-> DARBUOTOJAS, 3 -> DESTYTOJAS
            for (var k in konsultacijos) {

                //console.log(k);
                // KABINETAI
                if (konsultacijos[k].tipas.toString() === "1") {
                    var $Item1 = $("<div class='element-item transition metal' data-category='transition'>\n" +
                        "<div class='kabibetas'>" + konsultacijos[k].kabinetas.toString() + " kab.</div>\n" +
                        "<ul class='list-group'>\n" +
                        "<li class='list-group-item' align='center' style='top: -20px; font-size:x-large;'>\n" + konsultacijos[k].vardas.toUpperCase().toString() + "</li>\n" +
                        "</ul>\n" +
                        "</div>\n");

                    $('.grid').prepend($Item1)
                        .isotope('reloadItems').isotope({sortBy: 'original-order'});
                }
                // DARBUOTOJAI
                if (konsultacijos[k].tipas.toString() === "2") {

                    var $Item2 = $('      <div class="element-item transition metal" data-category="transition">' +
                        '<img src="' + konsultacijos[k].foto.toString() + '"\n' +
                        '        align="left" height="400px">\n' +
                        '            <ul class="list-group">\n' +
                        '           <li class="list-group-item">' + konsultacijos[k].vardas.toString() + '</li>\n' +
                        '       <li class="list-group-item">' + '<span style="font-weight: 900;\n' +
                        '    color: #2b1195;\n' +
                        '    font-size: x-large;">' + konsultacijos[k].kabinetas.toString() + ' kab.</span></li>\n' +
                        '            <li class="list-group-item">' + konsultacijos[k].laikas.toString() + '\n' +
                        '            </li>\n' +
                        '      </ul>\n' +
                        '      </div>');

                    $('.grid').prepend($Item2)
                        .isotope('reloadItems').isotope({sortBy: 'original-order'});

                }
                // DESTYTOJU KORTELES ATVAIZDAVIMAS
                for (var j in destytojai) {
                    if (destytojai[j].lastname.includes(konsultacijos[k].vardas)) {

                        if (konsultacijos[k].kabinetas === "") {
                            var $Item6 = $('      <div class="element-item transition metal" data-category="transition">' +
                                '<img src="' + konsultacijos[k].foto.toString() + '"\n' +
                                '        align="left" height="400px">\n' +
                                '            <ul class="list-group">\n' +
                                '           <li class="list-group-item">' + destytojai[j].firstname.toString() + ' ' + destytojai[j].lastname.toString() + '</li>\n' +
                                '            <li class="list-group-item">' + konsultacijos[k].laikas.toString() +
                                '            </li>\n' +
                                '            <li class="list-group-item">\n' +
                                '           <div class="links">\n' +
                                '            <a class="openpop" href="" id="' + "https://vikoeif.edupage.org/timetable/view.php?teacher=" + destytojai[j].id.toString() + '"><i class="far fa-calendar"></i> Paskaitų tvarkaraštis</a>\n' +
                                '       </div>\n' +
                                '        </li>\n' +
                                '      </ul>\n' +
                                '      </div>');

                            $('.grid').prepend($Item6)
                                .isotope('reloadItems').isotope({sortBy: 'original-order'});
                        } else {
                            var $Item3 = $('      <div class="element-item transition metal" data-category="transition">' +
                                '<img src="' + konsultacijos[k].foto.toString() + '"\n' +
                                '        align="left" height="400px">\n' +
                                '            <ul class="list-group">\n' +
                                '           <li class="list-group-item">' + destytojai[j].firstname.toString() + ' ' + destytojai[j].lastname.toString() + '</li>\n' +
                                '            <li class="list-group-item">' + konsultacijos[k].laikas.toString() + " <br/><strong style='color:#2b1195'>" + konsultacijos[k].kabinetas.toString() + ' aud.</strong>\n' +
                                '            </li>\n' +
                                '            <li class="list-group-item">\n' +
                                '           <div class="links">\n' +
                                '            <a class="openpop" href="" id="' + "https://vikoeif.edupage.org/timetable/view.php?teacher=" + destytojai[j].id.toString() + '"><i class="far fa-calendar"></i> Paskaitų tvarkaraštis</a>\n' +
                                '       </div>\n' +
                                '        </li>\n' +
                                '      </ul>\n' +
                                '      </div>');

                            $('.grid').prepend($Item3)
                                .isotope('reloadItems').isotope({sortBy: 'original-order'});
                        }

                        //console.log(JSON.parse(localStorage.getItem('konsultacijos'))[i].vardas+" "+destytojai[j].lastname+" "+i);


                    }
                }

            }


            $(".popup").hide();
            $(".openpop").click(function (e) {
                e.preventDefault();
                $('.close_mygtukas').show();
                window.scrollTo(0, 0);
                var destytojo_tvarkarascio_URL = e.target.id;

                $('.popup').html('<embed class="avoid-clicks" width="1024" heigth="820" id="InnerFrame" src="' + destytojo_tvarkarascio_URL + '">');
                $(".popup").fadeIn('slow');

            });
            $(".close").click(function () {
                $(this).parent().fadeOut("slow");
                $('.close_mygtukas').hide();
                $('.popup').hide();
                $(".flat-button").trigger('click');
            });
        });
    </script>


    <script>
        function startTime() {

            let today = new Date();
            let h = today.getHours();
            let m = today.getMinutes();
            let s = today.getSeconds();
            m = checkTime(m);
            s = checkTime(s);

            //let timeInminutes = Number(h * 60) + Number(m);
            // console.log(timeInminutes);

            let siandien = moment();
            siandien.locale('lt');
            $('#txt').text(siandien.format('YYYY MM DD, dddd,').toUpperCase() + " " + h + ":" + m + ":" + s);
            let t = setTimeout(startTime, 500);
        }

        function checkTime(i) {
            if (i < 10) {
                i = "0" + i
            } // add zero in front of numbers < 10
            return i;
        }


    </script>

</head>

<body onload="startTime();hideKeyboard();">

<!--<script src="app.js"></script>-->


<ul class="nav nav-tabs nav-justified red menu_virsutinis_prilipes" id="myTab" role="tablist">

    <li class="nav-item" style="font-weight: bold;"><img src="images/eif.jpg" width="50px" style="margin-top:3px;"
                                                         align="left">
        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home"
           aria-selected="true"><i class="far fa-edit"></i>LAIKINI PAKEITIMAI</a>
    </li>
    <li class="nav-item" style="font-weight: bold;">
        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
           aria-selected="false"><i class="fas fa-search"></i> DARBUOTOJAI</a>


    </li>
    <!--<span id='status' style='height: 100px;-->
    <!--width: 100px; background-image: url("images/live.png");display: inline-block; margin-top:40px;'></span>-->

</ul>


<!--<div id="virsun" class="sticky-container" style="top:0;"-->
<!--onclick="scrollWin(0, -200);">-->
<!--<i class="fas fa-caret-square-up fa-2x" style="color: #fff90094;"></i>-->
<!--</div>-->

<!--<div id="apacion" class="sticky-container" style="bottom:0;"-->
<!--onclick="scrollWin(0, 20);">-->
<!--<i class="fas fa-caret-square-down fa-2x" style="color: #fff90094;"></i>-->
<!--</div>-->


<script>


    $('#profile-tab').click(function () {


        $(".grid").show();
        hideKeyboard();
        $('input.quicksearch').val(' ');
        $("input.quicksearch").attr("placeholder",
            "Darbuotojų paieška, Įveskite pvz. pagal vardą, pavardę, pareigas, kabinetą.").val("").focus().blur();
        // $('div#apacion').css('top', '60%');
        // $('div#virsun').css('top', '40%');
        $(".popup").hide(); // TODO ADDED NEW CONTENT SU IFRAME ZAIDZIU
        $('.close_mygtukas').hide();


        //   console.log(localStorage.getItem('dest'));

        let teach = localStorage.getItem('dest');
        // JSON.parse(matched[0]).rows[k].short
        // console.log(teach[0]);
        // console.log(teach[0]);


        // console.log(JSON.parse(localStorage.getItem('dest')).rows[0].short,
        //     JSON.parse(localStorage.getItem('dest')).rows[0].id,
        //     "https://vikoeif.edupage.org/timetable/view.php?teacher=" + JSON.parse(localStorage.getItem('dest')).rows[0].id.toString() + "");
        //


        //$('.grid').append();


// TODO start
//         $('.grid').html("");
//
//         for(i in JSON.parse(localStorage.getItem('dest')).rows) {
//             var $Item = $('      <div class="element-item transition metal" data-category="transition"><img src="https://i1.wp.com/eif.viko.lt/media/uploads/sites/5/2018/04/no_photo.png?fit=150%2C150&ssl=1"\n' +
//                 '        align="left" height="400px">\n' +
//                 '            <ul class="list-group">\n' +
//                 '           <li class="list-group-item">'+JSON.parse(localStorage.getItem('dest')).rows[i].short.toString()+'</li>\n' +
//                 '       <li class="list-group-item"> lektorė</li>\n' +
//                 '            <li class="list-group-item"> Penktadieniais, 9:30 – 11:00 208 kab.\n' +
//                 '            </li>\n' +
//                 '            <li class="list-group-item">\n' +
//                 '           <div class="links">\n' +
//                 '            <a class="openpop" href="'+"#" +'"\n' +
//                 '        id="'+"https://vikoeif.edupage.org/timetable/view.php?teacher=" + JSON.parse(localStorage.getItem('dest')).rows[i].id.toString() +'"><i class="far fa-calendar"></i> Paskaitų tvarkaraštis</a>\n' +
//                 '       </div>\n' +
//                 '        </li>\n' +
//                 '      </ul>\n' +
//                 '      </div>');
//             $('.grid').prepend($Item)
//                 .isotope('reloadItems').isotope({sortBy: 'original-order'});
//         }
// TODO END


    });

    function scan() {
        alert('VALIO');
    }

    $('#home-tab').click(function () {


        $(".grid").hide();
//        $('div#apacion').css('top', '400px');
//        $('div#virsun').css('top', '150px');
        let today = moment();
        $('p.active').removeClass('active'); //Clear all checked class on .size
        $('p#pid' + today.format('DD')).addClass('active'); //Add checked class to current clicked .siz
        readAndDisplayData(today.format('DD').toString());
        hideKeyboard();
    });

    function scrollWin(x, y) {
        hideKeyboard();
        window.scrollBy(x, y);
    }
</script>


<div class="tab-content" id="myTabContent">

    <!--PAKEITIMAI ARBA PAGRINDINIS PUSLAPIS-->

    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">


        <div class="container" id="savaites_dienos">


            <div class="row savaites_dienos_fiksuotas">


            </div>
        </div>

        <script>

            $(".simple-keyboard").hide();

            let date = moment(new Date()),
                begin = moment(date).isoWeekday(1);

            begin.startOf('iweek');
            begin.locale('lt');

            let today = moment();
            today.locale('lt');

            let past_day = Number(today.format('DD') - 1);

            // EIF LOGOTIPAS
            //  $(".container#savaites_dienos").find('div.row').append('<div style="padding: 20px; border-right: solid 2px grey; background:white;"><img src="images/eif.jpg" width="200px"></div>');


            for (let i = 0; i < 8; i++) {


                // $(".container#savaites_dienos").find('div.row').append('<div class=".col-xl- dayMonth" id="' + begin.format('DD') +'"' +
                //     '          <p style="font-size: 60px;" align="center" id="pid' + begin.format('DD') + '">' + begin.format('DD') + '</p>\n' +
                //     '          <p style="font-weight: bold; padding:5px; font-size: 20px; color:black;" align="center">' + moment(begin).locale('lt').format('dddd').toUpperCase() + '</p>\n' +
                //     '<div style="font-size: 40px;" align="center" id="stateid' + begin.format('DD') + '">' +
                //     begin.format('MMMM', 'lt').toUpperCase() + '</div>' +
                //     '        </div>');

                // language=HTML
                $(".container#savaites_dienos").find("div.row").append('<div class=".col-xl- dayPrimary" id="' + begin.format('DD') + '">\n    ' +
                    '<div class="dayMonth" align="center" id="stateid' + begin.format('DD') + '">' + begin.format('MMMM', 'lt').toUpperCase() + "</div>" +
                    '<p class="dayNumber" align="center" id="pid' + begin.format('DD') + '">' + begin.format('DD') + '</p>' +
                    '<p class="dayString" align="center" id="dayid' + begin.format('DD') + '">' + moment(begin).locale('lt').format('dddd').toUpperCase() + '</p></div>');


                if (i === 5 || i === 6) {
                    console.log(begin.format('DD'));
                    $("#" + begin.format('DD')).hide();
                }
                // Kalendoriaus elementu krastai
//                $('p#pid' + begin.format('DD')).css({'border': '1px solid grey', "padding":"0",
//                    "box-sizing": "border-box", "-moz-box-sizing": "border-box", "-webkit-box-sizing": "border-box"});
                $('div#' + begin.format('DD')).css({'border-right': '2px solid grey'});
                // $('p#pid' + begin.format('DD')).css({
                //     'color': 'red'
                // });

                // -moz-box-sizing: border-box;
                //-webkit-box-sizing: border-box;
                begin.add(1, 'd');

            }

            for (let k = 1; k < 10; k++) {
                $('div#' + moment().subtract(k, 'days').startOf('day').format('DD')).css({
                    "background-color": "#ccc",
                    "color": "grey"
                });
                if ($('div#' + moment().subtract(k, 'days').startOf('day').format('DD')).css({
                    "background-color": "#ccc",
                    "color": "grey"
                })) {

                    $('div#' + moment().subtract(k, 'days').startOf('day').format('DD')).css({
                        "background-color": "#ccc",
                        "color": "grey"
                    }).remove();

                    //alert('PRAEJUSI DIENA');
                }
            }

            // $('div#' + today.format('DD')).css({'border': '7px solid black', "border-radius":"20px"});


            // $('p#pid' + today.format('DD')).css({
            //     'color': 'red'
            // });

            $('p#pid' + today.format('DD')).addClass('active');

            $('p#dayid' + today.format('DD')).addClass('active');



            let siandien = moment();

            $('p#pasirinkta_diena').text('' + siandien.format('DD'));

            $('div.row p').click(function (e) {
                let diena = $(e.target).text();
                $('p#pasirinkta_diena').text(diena);

                // $('p#dayid' + today.format('DD')).removeClass('active');

                $.dienaSelektorius = $('p#dayid' + diena);
                $('p#dayid' + today.format('DD')).css('color', '#023277');

                // GRID POZIJA KADANGI NUSOKA KAI PASPAUDZIAM
                $(".grid").css('margin-top', '22px');
                $("div.popup").css('margin-top', '-87px');

                if ($(e.target).css('color') === 'rgb(128, 128, 128)') {
                    console.log('Praėjusi diena.');
                } else {
                    $('p.active').removeClass('active'); //Clear all checked class on .size
                    $('p#pid' + diena).addClass('active'); //Add checked class to current clicked .siz

                    // AKTYVI DIENA
                    $.dienaSelektorius.removeClass('active');
                    $.dienaSelektorius.addClass('active');

                    readAndDisplayData(diena.toString());
                }
                // $('p#dayid' + today.format('DD')).addClass('active');
            });
        </script>


        <div class="container" style="float: left; width: 100%; margin-top: 0px; ">


            <table class="table table-dark table-striped" id="pakeitimai">
                <thead>
                <tr>
                    <th>Paskaita</th>
                    <th>Grupė</th>
                    <th>Dėstytojas</th>
                    <th>Auditorija</th>
                </tr>
                </thead>
                <tbody>
                <!--<tr>-->
                <!--<td>[1] 7<sup>45</sup> - 9<sup>30</sup></td>-->
                <!--<td>PI17A [1 pogr.]</td>-->
                <!--<td>Marius Gžegoževskis</td>-->
                <!--<td>420a</td>-->
                <!--</tr>-->
                <tr>
                    <td colspan="4">INFORMACIJA KRAUNASI...</td>
                </tr>

                </tbody>
            </table>


        </div>

        <!--END DESTYTOJU PAKEITIMU SARASAS-->

    </div>
    <p id="pasirinkta_diena" style="color:#00308f;">

    </p>


    <!--END PAKEITIMAI-->

    <!--DESTYYOJAI ARBA DESTYTOJU PAIESKA-->
    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">


        <div class="topnav">

            <div class="search-container">


                <p class="paieskos_laukas_zemiau_menu"><input type="text" class="quicksearch"
                                                              placeholder="Darbuotojų paieška, pvz. pagal vardą, pavardę, pareigas, kabinetą."
                                                              onfocus="clearSearchField()"
                                                              onclick="clearSearchField(); showKeyboard();"/>


                </p>


            </div>


        </div>


        <a class="close_mygtukas" style="background: red;     font-size: 40pt;
    width: 80px;color:white;font-weight:bold;border:1px solid grey;" href="#"> <span
                style="">X</span>
        </a>

        <script>

            $('.close_mygtukas').hide();
            $('.close_mygtukas').click(function () {
                $('.popup').hide();
                $('.close_mygtukas').hide();
            });
        </script>


        <!--IFRAME POZICIJA-->
        <div class="wrapper">


            <div class="popup" style="overflow: hidden;display: inherit;">

                <!--<iframe style="margin-top: 90px" src="view.html" width="2900px" height="2000px" id="InnerIframe"-->
                <!--scrolling="no">-->
                <!--<p>Your browser does not support iframes.</p>-->
                <!--</iframe>-->
                <!--<div id="block" style="position: absolute; top: 0; left: 0; width: 2900px; height:2100px">-->
                <!--<a style="margin-top: 290px; background: red; padding: 20px; font-size:40pt;color:white; font-weight: bold;border:1px solid grey;" href="#" class="close">X-->
                <!--</a>-->


            </div>


        </div>
    </div>
    <!--IFRAME END-->


    <!--<KLAVIATURA IS APACIOS" />-->
    <div style="bottom:50px; background: white; position: fixed; z-index: 5000;" class="simple-keyboard"></div>

    <script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.min.js"></script>
    <script src="src/index.js"></script>

    <div class="grid">

    </div>

</div>


<script>
    // external js: isotope.pkgd.js


    // init Isotope
    var qsRegex;

    // init Isotope
    var $grid = $('.grid').isotope({
        itemSelector: '.element-item',
        layoutMode: 'fitRows',
        filter: function () {
            return qsRegex ? $(this).text().match(qsRegex) : true;
        }
    });

    // use value of search field to filter
    var $quicksearch = $('.quicksearch').keyup(debounce(function () {
        qsRegex = new RegExp($quicksearch.val(), 'gi');
        $grid.isotope();
    }, 200));

    // debounce so filtering doesn't happen every millisecond
    function debounce(fn, threshold) {
        var timeout;
        threshold = threshold || 100;
        return function debounced() {
            clearTimeout(timeout);
            var args = arguments;
            var _this = this;

            function delayed() {
                fn.apply(_this, args);
            }

            timeout = setTimeout(delayed, threshold);
        };
    }


</script>

<script src="firebase.js"></script>

<script>
    const config = {
        apiKey: "AIzaSyCRYVIHl_orktaBMwsmlQtMcOaeGO0FTQI",
        authDomain: "eif-courses.firebaseapp.com",
        databaseURL: "https://eif-courses.firebaseio.com",
        projectId: "eif-courses",
        storageBucket: "eif-courses.appspot.com",
        messagingSenderId: "535363326769"
    };
    firebase.initializeApp(config);
</script>




<!--FOOOTER LYGINE SAVAITE IR LAIKRODIS-->
<footer>
    <ul class="nav nav-tabs nav-justified red" role="tablist" style="font-size: xx-large;">


        <li class="nav-item">
            <a id="txt" data-toggle="tab" role="tab" aria-controls="profile"
               aria-selected="false" style="font-weight: bold;">9:45:15</a>
            <span id="kelinta_savaite" style="font-weight: bold;     background: red;
    padding: 4px;"> 2 SAVAITĖ</span>
        </li>
        <script>

            Date.prototype.getWeek = function () {
                var target = new Date(this.valueOf());
                var dayNr = (this.getDay() + 6) % 7;
                target.setDate(target.getDate() - dayNr + 3);
                var firstThursday = target.valueOf();
                target.setMonth(0, 1);
                if (target.getDay() != 4) {
                    target.setMonth(0, 1 + ((4 - target.getDay()) + 7) % 7);
                }
                return 1 + Math.ceil((firstThursday - target) / 604800000);
            };

            const savaitesDienaIsDB = firebase.database().ref("savaite/");
            savaitesDienaIsDB.on("value", function (snapshot) {

                let d = new Date();
                let kelinta = d.getWeek()+snapshot.val();
                if (kelinta % 2 === 1) {
                    $("#kelinta_savaite").text(" 1 SAVAITĖ");
                } else {
                    $("#kelinta_savaite").text(" 2 SAVAITĖ");
                }
                //console.log(snapshot.val());
                //kelinta = d.getWeek() + snapshot.val();
                //console.log(kelinta);
            });






            //alert(d.getWeek()+1);
        </script>


    </ul>
</footer>

<!--CRAWLER IŠSAUGOTI DĖSTYTOJUS IŠ EIF TVARKARAŠČIŲ-->
<script>
    // $.get('https://vikoeif.edupage.org/timetable/').success(function(data){
    //     let matched = data.match(/{"table":"teachers",[\w\W]*?\(-a\)"}]}/gm);
    //     //for (let k in matched[0]) {
    //         localStorage.setItem('dest', matched[0]);
    //         // console.log(JSON.parse(matched[0]).rows[k].short,
    //         //     JSON.parse(matched[0]).rows[k].id,
    //         //     "https://vikoeif.edupage.org/timetable/view.php?teacher=" + JSON.parse(matched[0]).rows[k].id.toString() + "");
    //
    //    // }
    //
    // });
</script>


<script>

    // TODO HIDE KEYBOAR NAUJAS STENDAS
    function hideKeyboard() {
        $(".simple-keyboard").hide();
    }

    function goBack() {
        window.history.back()
    }

    (function (poll, timeout) {

        let _idle = false,
            _lastActive = 0,
            _activeNow = function () {
                _lastActive = new Date();

                if (_idle) {
//$('.screensaver').hide();
                    _idle = false;
                }
            },
            _poll = function () {

                let elapsed = (new Date()) - _lastActive;

                if ((elapsed > timeout) && !_idle) {


                    if (navigator.onLine) {
                        //window.location.assign("https://stendas.github.io");
                       // $('p#dayid' + today.format('DD')).addClass('active');
                        $('p#dayid' + today.format('DD')).css('color', 'red');
                        $('#home-tab i').trigger('click');
                        $('.simple-keyboard').hide();


                        console.log('ONLINE');
                        //$('#status').css('background-image', 'url("images/live.png")');

                    } else {
                        console.log('OFFLINE');
                        //$('#status').css('background-image', 'url("images/offlinestatus.png")');
                        //alert('offline we stay offline version till internet goes live');
                    }
                    //alert('hello');
                    //$('.screensaver').fadeIn('slow');
                    _idle = true;
                }
            };

        $(window).bind('mousemove click keypress resize focus', _activeNow);

        window.setInterval(_poll, poll);

        _activeNow();
    })(2000, 120 * 1000);
</script>

<script>
    (function (poll, timeout) {

        let _idle = false,
            _lastActive = 0,
            _activeNow = function () {
                _lastActive = new Date();

                if (_idle) {
//$('.screensaver').hide();
                    _idle = false;
                }
            },
            _poll = function () {

                let elapsed = (new Date()) - _lastActive;

                if ((elapsed > timeout) && !_idle) {


                    if (navigator.onLine) {
                        window.location.assign("https://stendas.github.io");
                        // $('p#dayid' + today.format('DD')).addClass('active');
                        // $('p#dayid' + today.format('DD')).css('color', 'red');
                        // $('#home-tab i').trigger('click');
                        // $('.simple-keyboard').hide();
                        console.log('ONLINE');
                        //$('#status').css('background-image', 'url("images/live.png")');

                    } else {
                        console.log('OFFLINE');
                        //$('#status').css('background-image', 'url("images/offlinestatus.png")');
                        //alert('offline we stay offline version till internet goes live');
                    }
                    //alert('hello');
                    //$('.screensaver').fadeIn('slow');
                    _idle = true;
                }
            };

        $(window).bind('mousemove click keypress resize focus', _activeNow);

        window.setInterval(_poll, poll);

        _activeNow();
    })(2000, 3600 * 1000);
</script>




<script>
    // Firbease Init




    function getChangesByDate() {

        const dbRefObject = firebase.database().ref("user-posts/");

        const pakeitimaiDiv = document.getElementById("pakeitimai");


        dbRefObject.orderByChild('paskaita').on("value", function (snapshot) {
            let destytoju_pakeitimai = "";

            pakeitimaiDiv.innerHTML = "";


            //'<th colspan="4" style="background: white!important; color:red; font-size:50pt">DĖMESIO! Konsultacijos vyks pagal patvirtintą konsultacijų tvarkaraštį 2018.10.29-2018.11.02, plačiau žr. https://eif.viko.lt.</th>'+
            document.getElementById("pakeitimai").innerHTML =
                '<tr><th>PASKAITA</th>' +
                '<th>GRUPĖ</th>' +
                '<th>DĖSTYTOJAS</th>' +
                '<th>AUDITORIJA</th></tr></thead>';

            const laiko_intervalas = ["7<sup>45</sup> - 9<sup>15</sup>", "9<sup>30</sup> - 11<sup>00</sup>", "11<sup>45</sup> - 13<sup>15</sup>",
                "13<sup>30</sup> - 15<sup>00</sup>", "15<sup>15</sup> - 16<sup>45</sup>", "17<sup>15</sup>" +
                " - 18<sup>30</sup>", "18<sup>45</sup> - 20<sup>15</sup>", "20<sup>30</sup> - 22<sup>00</sup>"];


            snapshot.forEach(function (data) {

                const newPlayer = data.val();


                if (newPlayer.date === (moment().format('ddd MMM DD YYYY'))) {

                    destytoju_pakeitimai +=
                        '<tr><td style="text-align: center;"><b>' + newPlayer.paskaita + '</b> ' +
                        '</td><td>' + newPlayer.grupe.toUpperCase() + '</td><td>' +
                        newPlayer.destytojas + '</td><td>' + newPlayer.auditorija.toUpperCase() + '</td></tr>';
                    //moment.locale('lt');

                    let today = moment();
                    today.locale('lt');


                }
            });

            pakeitimaiDiv.innerHTML += '<tbody">' +
                destytoju_pakeitimai + '</tbody>';
            pakeitimaiDiv.innerHTML += '<br/><br/>';
        });

    }

    function stringifyTomorrow() {
        let today = moment();
        let tomorrow = today.add(1, 'days');
        return moment(tomorrow).format("ddd MMM DD YYYY");
    }

    function currentDay() {
        let today = moment();
        today.locale('lt');

    }

    //  currentDay();
    function nextDay() {
        let today = moment();
        let tomorrow = today.add(1, 'days');
        tomorrow.locale('lt');

        document.getElementById("tommorow").innerText = tomorrow.format('DD');
        document.getElementById("currentMonthTommorow").innerText = tomorrow.format('MMMM', 'lt').toUpperCase();
        document.getElementById("currentWeekDayTomorrow").innerText = tomorrow.format('dddd', 'lt').toUpperCase();

    }

    getChangesByDate();


</script>


<script>


    // TODO hide text from text
    $(".quicksearch").focus(function () {
        keyboard.setInput("");
        var e = $.Event("keyup", {keyCode: 13});
        $('.quicksearch').trigger(e);
        //hideKeyboard();
    });

    function clearSearchField() {
        $("input.quicksearch").val("");
        $(".popup").hide();
        $("a.close_mygtukas").hide();
        //TODO ZAIDZIU SU FRAME
    }

    // TODO FUNKCIJA SUKURTA NAUJAS STENDAS 2018 11 05
    function showKeyboard() {
        $(".simple-keyboard").show();
    }


    function readAndDisplayData(diena) {

        const dbRefObject = firebase.database().ref("user-posts/");

        const pakeitimaiDiv = document.getElementById("pakeitimai");
        let date_from_user = diena;

// TODO REIKIA PRIDETI LEMTELES ANTRASTE SEKANCIA IS PASKOS
        dbRefObject.orderByChild('paskaita').on("value", function (snapshot) {
            let keitimai = "";
            pakeitimaiDiv.innerHTML = "";

            //"<th colspan=\"4\" style=\"background: white!important; color:red; font-size:50pt\">DĖMESIO! Konsultacijos vyks pagal patvirtintą konsultacijų tvarkaraštį 2018.10.29-2018.11.02, plačiau žr. https://eif.viko.lt.</th>"+

            document.getElementById("pakeitimai").innerHTML = '<thead>' + '<tr><th>PASKAITA</th>' + '<th>GRUPĖ</th>' + '<th>DĖSTYTOJAS</th>' + '<th>AUDITORIJA</th></tr></thead>';

            const laiko_intervalas = ["7<sup>45</sup> - 9<sup>15</sup>", "9<sup>30</sup> - 11<sup>00</sup>", "11<sup>45</sup> - 13<sup>15</sup>",
                "13<sup>30</sup> - 15<sup>00</sup>", "15<sup>15</sup> - 16<sup>45</sup>", "17<sup>15</sup>" +
                " - 18<sup>30</sup>", "18<sup>45</sup> - 20<sup>15</sup>", "20<sup>30</sup> - 22<sup>00</sup>"];

            snapshot.forEach(function (data) {

                const newPlayer = data.val();

                let menuo = moment(newPlayer.date).locale('lt').format('MMMM');
                let pasirinkta_diena_is_kalendoriaus = $('#stateid' + date_from_user).text();

                // TODO need FIX IF STATEMENT BLOGAI TIKRINA NEKREIPIA DEMESIO I EINAMUOSIUS METUS !!!!!!
                if (moment(newPlayer.date).format('DD') === date_from_user && menuo.toUpperCase() ===
                    pasirinkta_diena_is_kalendoriaus && moment(newPlayer.date).format('YYYY') === $('a#txt').text().substr(0, 4)) {
                    keitimai +=
                        '<tr><td style="text-align: center;"><b>' + newPlayer.paskaita + '</b> ' +
                        '</td><td>' + newPlayer.grupe.toUpperCase() + '</td><td>' +
                        newPlayer.destytojas + '</td><td>' + newPlayer.auditorija.toUpperCase() + '</td></tr>';
                }

            });
            pakeitimaiDiv.innerHTML += '<tbody>' + keitimai + '</tbody>';
            pakeitimaiDiv.innerHTML += '<br/>';
        });

    }
</script>

<script>


</script>


</body>
</html>
